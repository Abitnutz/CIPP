"use strict";(self.webpackChunkcipp_docs=self.webpackChunkcipp_docs||[]).push([[7821],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1670:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],s={id:"samwizard",title:"SAM Wizard",description:"Setup access to my clients",slug:"/gettingstarted/postinstall/samwizard"},l=void 0,c={unversionedId:"gettingstarted/postinstall/samwizard",id:"gettingstarted/postinstall/samwizard",title:"SAM Wizard",description:"Setup access to my clients",source:"@site/docs/user/gettingstarted/postinstall/samwizard.md",sourceDirName:"gettingstarted/postinstall",slug:"/gettingstarted/postinstall/samwizard",permalink:"/docs/user/gettingstarted/postinstall/samwizard",editUrl:"https://github.com/KelvinTegelaar/CIPP/tree/website/docs/user/gettingstarted/postinstall/samwizard.md",tags:[],version:"current",lastUpdatedBy:"KelvinTegelaar",lastUpdatedAt:1680798998,formattedLastUpdatedAt:"06/04/2023",frontMatter:{id:"samwizard",title:"SAM Wizard",description:"Setup access to my clients",slug:"/gettingstarted/postinstall/samwizard"},sidebar:"userSidebar",previous:{title:"Run from Package mode",permalink:"/docs/user/gettingstarted/postinstall/runfrompackage"},next:{title:"Clear Token Cache",permalink:"/docs/user/gettingstarted/postinstall/cleartokencache"}},u={},p=[{value:"Authorization best practices for CIPP",id:"authorization-best-practices-for-cipp",level:2},{value:"Executing the wizard",id:"executing-the-wizard",level:2}],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"setup"},"Setup"),(0,i.kt)("p",null,"This section describes the best practices and recommended setup for CIPP, including account usage, multi factor authentication, and DAP/GDAP groups. This section also describes the recommended setup for Conditional Access Policies. When this document has not been implemented you could encounter issues with the CSP, Graph, or Exchange sections of CIPP."),(0,i.kt)("h2",{id:"authorization-best-practices-for-cipp"},"Authorization best practices for CIPP"),(0,i.kt)("p",null,"to setup the Graph API, CSP, and Exchange integration CIPP requires a minimum level of permissions. We recommend to setup the account as follows"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'Create a new account. Recommended to name this "CIPP Integration" and give it the username "',(0,i.kt)("a",{parentName:"li",href:"mailto:CIPP@domain.tld"},"CIPP@domain.tld"),'"\na. This account must be a Global Administrator while setting up the integration. These permissions may be removed after the integration has been setup.'),(0,i.kt)("li",{parentName:"ol"},"Add the account to the correct groups")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'If you are using DAP The CIPP user must be added to the "AdminAgents" group. '),(0,i.kt)("li",{parentName:"ul"},"If you are using GDAP, the CIPP user must be added to the groups you've assigned for GDAP has made. The minimum permissions CIPP needs to function are:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Application Administrator"),(0,i.kt)("li",{parentName:"ul"},"User Administrator"),(0,i.kt)("li",{parentName:"ul"},"Intune Administrator"),(0,i.kt)("li",{parentName:"ul"},"Exchange Administrator"),(0,i.kt)("li",{parentName:"ul"},"Security Administrator"),(0,i.kt)("li",{parentName:"ul"},"Cloud App Security Administrator"),(0,i.kt)("li",{parentName:"ul"},"Teams Administrator"),(0,i.kt)("li",{parentName:"ul"},"Sharepoint Administrator"),(0,i.kt)("li",{parentName:"ul"},"Privileged Authentication Administrator (Required to revoke sessions, reset admin passwords, and set up application policies)")))),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},"This account must have ",(0,i.kt)("strong",{parentName:"li"},"Microsoft")," multi-factor authentication enforced for each logon, either via Conditional Access when available or via ",(0,i.kt)("a",{parentName:"li",href:"https://account.activedirectory.windowsazure.com/UserManagement/MultifactorVerification.aspx"},"Per User MFA")," when Conditional Access is not available. ")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"You may not use any other authentication provider than Microsoft for this account. Duo or other providers will not work. For more information on this see ",(0,i.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/partner-center/partner-security-requirements-mandating-mfa#supported-mfa-options"},"this")),(0,i.kt)("li",{parentName:"ul"},"The CIPP service account requires MFA for each logon. That means no excluded locations may be applied nor authentication length policies. See the chapter about conditional access to make sure your policies are configured correctly.")),(0,i.kt)("h2",{id:"executing-the-wizard"},"Executing the wizard"),(0,i.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Requirements")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Make sure you are logged into CIPP under your own account (",(0,i.kt)("a",{parentName:"p",href:"mailto:user@domain.com"},"user@domain.com"),"). The CIPP Wizard will prompt you to logon with the account for the integration used above. The wizard will not use SSO or automatically logon."),(0,i.kt)("p",{parentName:"div"},"Your browser ",(0,i.kt)("strong",{parentName:"p"},"MUST")," allow cookies and have any ad-blocker disabled for the duration of the wizard. Do not use in-private mode."))),(0,i.kt)("p",null,"To setup the connection to your tenants you'll need to run the Sam Wizard. The Sam Wizard can be found under Settings -> SAM Setup Wizard. The Wizard will present you with multiple options. If this is your first setup it is recommended to choose \"I'd like CIPP to create a SAM Application for me\"."),(0,i.kt)("p",null,"When executing the Sam Wizard with \"I'd like CIPP to create a SAM Application for me\" you'll be presented with a button to start the Wizard. Do not navigate away from this page and execute all ",(0,i.kt)("strong",{parentName:"p"},"5 steps")," that this page will prompt you for."),(0,i.kt)("p",null,"After completing the wizard 5 steps, you must ",(0,i.kt)("a",{parentName:"p",href:"https://cipp.app/docs/general/troubleshooting/#clear-token-cache"},"clear the token cache"),"."))}m.isMDXComponent=!0}}]);